# 路径规划器配置（按类别组织）

visualization:
  # 同时用于栅格与路径可视化
  scale: 4
  show_grid_lines: true
  use_antialiasing: true
  image_format: "png"
  save_path_visualization: true
  # 相对路径将自动挂到 ${XLINE_WS_ROOT} 下
  output_dir: "xline_path_planner/path_visualizations"   # 栅格/路径可视化输出目录
  planned_output_dir: "xline_path_planner/planned_results"  # 规划JSON输出目录

cad_parser:
  unit_conversion_factor: 1000.0   # 毫米->米
  auto_scale_coordinates: true
  angle_unit: "DEGREES"            # 可选: DEGREES | RADIANS
  # 相对路径会挂到 ${XLINE_WS_ROOT} 下
  cad_file_dir: "xline_server/uploads/json_transformed"   # CAD文件所在目录（服务端，坐标转换后的JSON）

grid_map:
  resolution: 0.005   # 米/格
  padding: 0.1        # 地图边界填充(米)

offsets:
  left_offset: -0.25      # 左侧打印机偏移(m)
  right_offset: 0.25      # 右侧打印机偏移(m)
  center_offset: 0.0      # 中心打印机偏移(m)

path_planner:
  path_extension_start_length: 0.25 # 绘图路径起点端延长长度（米），仅影响输出轨迹/可视化，不参与共线判断
  path_extension_end_length: 0.05   # 绘图路径终点端延长长度（米），仅影响输出轨迹/可视化，不参与共线判断

geometry_preprocessing:
  split_polyline: true              # 是否将 CAD 的 Polyline 拆分为多条 Line 参与规划
  preserve_polyline_info: true      # 拆分后是否保留 polyline 来源信息（parent_id/segment_index）
  merge_collinear: true             # 是否合并“共线且端点相连”的直线段为一条路径
  distance_tolerance: 0.001         # 距离容差（米），用于端点相连/点到直线距离判定（默认 1mm）
  angle_tolerance: 0.001            # 角度容差（弧度），用于方向夹角判定（越小越严格）
  min_segment_length: 0.0005        # 最小线段长度（米），短于该值的线段不参与共线合并

# 可选：TCP服务器配置（用于非ROS客户端调用）
tcp_server:
  enabled: true                     # 是否启用 TCP 服务
  host: "192.168.0.123"             # 监听地址（0.0.0.0 表示监听所有网卡）
  port: 52088                       # 监听端口

# 可选：机器人起始位置配置
robot_start:
  enabled: true                     # 是否启用机器人起始位置
  pose_topic: "/robot_pose"         # 机器人位置话题名
  pose_timeout_sec: 5.0             # 位置超时时间（秒）
  required: false                   # 是否必须有位置才能规划（false表示没有位置时使用默认起点）
  max_initial_distance: 100.0       # 机器人到第一条路径的最大距离限制（米）
